import"./base-e7f1e9cc.js";import{E as B,a as T}from"./el-form-item-4f0e28e0.js";import{E as F,a as q,S as z}from"./sortable.esm-19a3c4e3.js";import"./el-scrollbar-22fc04de.js";import"./el-tooltip-4ed993c7.js";import"./el-popper-5ba6e9ae.js";import{E as M}from"./el-button-9d0ba982.js";import{o as E,c as g,L as _,_ as N,r as w,d as U,k as A,y as L,b as t,w as l,S as $,a as k,F as O,am as P,an as j}from"./index-ea08172c.js";import{E as G}from"./el-input-f8c105f0.js";import{n as S}from"./nanoid-1c86ba39.js";import{E as J}from"./index-2d2c1f52.js";import"./index-1d99722b.js";import"./event-e06a23af.js";import"./index-714188a9.js";import"./index-4fc09483.js";import"./objects-2d2aae1c.js";import"./focus-trap-4763f64c.js";import"./aria-60e0cdc6.js";import"./isNil-c75b1b34.js";import"./index-0e4e7197.js";import"./typescript-defaf979.js";const K={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Q=_("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),R=[Q];function W(f,u){return E(),g("svg",K,R)}const X={name:"ep-plus",render:W};const Y={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Z=_("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64h261.44zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64h453.44zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64h133.44z"},null,-1),ee=[Z];function te(f,u){return E(),g("svg",Y,ee)}const oe={name:"ep-operation",render:te};const ae=f=>(P("data-v-9616b8de"),f=f(),j(),f),le=["sortable-id"],ne=ae(()=>_("span",null,[_("span",{style:{color:"red"}},"*"),k("参数值")],-1)),re={__name:"index",setup(f){const u=(e=null)=>({parentId:(e==null?void 0:e.id)||null,id:S(10),name:S(5),value:""}),c=w((()=>{const e=[u(),u(),u()];return e.forEach(n=>{e.push(u(n)),e.push(u(n))}),e})()),H=e=>{const n=[];e.forEach(o=>o.children=[]),e.forEach((o,a,d)=>{o.parentId===null?n.push(o):d.find(s=>s.id===o.parentId).children.push(o)});function p(o,a){o.forEach((d,i)=>{d.prop=a+i,d.children.length>0&&p(d.children,`${d.prop}.children.`)})}return p(n,"renderData."),n},h=w({rules:{value:[{required:!0,message:"必填",trigger:"blur"}]},renderData:[]});U(()=>c.value,e=>{h.value.renderData=H(e)},{immediate:!0});const C=()=>{let e=null,n=null,p=null;const o=document.querySelector(".el-table__body-wrapper tbody");return new z(o,{forceFallback:!0,fallbackClass:"sortable-fallback",handle:".el-table__cell:first-child",draggable:".el-table__row",onStart(a){const i=a.item.querySelector("span[sortable-id]").getAttribute("sortable-id");e=c.value.find(s=>`${s.id}`==`${i}`)},onMove(a){return p=a.related,!1},onEnd(a){if(!p)return;const d=p.querySelector("span[sortable-id]").getAttribute("sortable-id");n=c.value.find(s=>`${s.id}`==`${d}`);function i(s,m,v){return m?m.parentId===s.id?!0:m?i(s,v.find(b=>b.id===m.parentId),v):!1:!1}if(i(e,n,c.value)){console.warn("不能放置到子节点下");return}e.parentId=n.id,c.value=[...c.value]}})};let x=null;A(()=>{x=C()}),L(()=>{x.destroy()});const y=w(null),V=async()=>{await y.value.validate()},D=e=>{c.value=[...c.value,u(e)]};return(e,n)=>{const p=oe,o=J,a=F,d=G,i=B,s=X,m=M,v=q,b=T;return E(),g(O,null,[t(b,{ref_key:"form",ref:y,rules:h.value.rules,model:h.value},{default:l(()=>[t(v,{data:h.value.renderData,"row-key":"id","default-expand-all":""},{default:l(()=>[t(a,{type:"index",label:"",width:"44"},{default:l(r=>[_("span",{"sortable-id":r.row.id},[t(o,{"data-id":r.id},{default:l(()=>[t(p)]),_:2},1032,["data-id"])],8,le)]),_:1}),t(a,{prop:"name",label:"参数名称",width:"500"},{default:l(r=>[_("span",null,$(r.row.name),1)]),_:1}),t(a,{prop:"value",label:"参数值",width:"300"},{header:l(()=>[ne]),default:l(r=>[t(i,{prop:`${r.row.prop}.value`,rules:h.value.rules.value},{default:l(()=>[t(d,{modelValue:r.row.value,"onUpdate:modelValue":I=>r.row.value=I,maxlength:30,placeholder:"请输入参数值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),t(a,{prop:"id",label:"id",width:"200px"},{default:l(r=>[_("span",null,$(r.row.id),1)]),_:1}),t(a,{prop:"id",label:"操作",width:"70"},{default:l(r=>[t(m,{onClick:I=>D(r.row)},{default:l(()=>[t(o,null,{default:l(()=>[t(s)]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["rules","model"]),_("div",null,[t(m,{type:"primary",onClick:V},{default:l(()=>[k(" 提交 ")]),_:1})])],64)}}},Ce=N(re,[["__scopeId","data-v-9616b8de"]]);export{Ce as default};
