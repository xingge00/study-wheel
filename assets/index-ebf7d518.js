import{o as E,c as x,N as m,P as T,r as g,m as A,l as F,p as U,G as q,b as a,w as n,O as S,a as k,F as M,$ as N,a0 as O}from"./index-274faae7.js";import{E as P,a as Z}from"./el-form-item-3d6cc015.js";import{E as G,a as R,S as j}from"./sortable.esm-8518297e.js";import"./el-scrollbar-ce87f6cc.js";import{E as J}from"./el-button-44cd7fe3.js";import{E as K}from"./el-input-4516e7eb.js";import"./get-e7313515.js";import"./objects-42526cee.js";import"./index-a170027c.js";import"./event-9519ab40.js";import"./index-197c75cb.js";import"./index-b6b8256e.js";const L={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},Q=m("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),W=[Q];function X(d,t){return E(),x("svg",L,W)}const Y={name:"ep-plus",render:X},ee={viewBox:"0 0 1024 1024",width:"1.2em",height:"1.2em"},te=m("path",{fill:"currentColor",d:"M389.44 768a96.064 96.064 0 0 1 181.12 0H896v64H570.56a96.064 96.064 0 0 1-181.12 0H128v-64h261.44zm192-288a96.064 96.064 0 0 1 181.12 0H896v64H762.56a96.064 96.064 0 0 1-181.12 0H128v-64h453.44zm-320-288a96.064 96.064 0 0 1 181.12 0H896v64H442.56a96.064 96.064 0 0 1-181.12 0H128v-64h133.44z"},null,-1),ae=[te];function le(d,t){return E(),x("svg",ee,ae)}const oe={name:"ep-operation",render:le};let C=(d=21)=>crypto.getRandomValues(new Uint8Array(d)).reduce((t,f)=>(f&=63,f<36?t+=f.toString(36):f<62?t+=(f-26).toString(36).toUpperCase():f>62?t+="-":t+="_",t),"");function H(d){let t=C(d).trim();for(;!/^[a-zA-Z][a-zA-Z0-9]*$/.test(t);)t=C(d).trim();return t}const ne=d=>(N("data-v-9616b8de"),d=d(),O(),d),re=["sortable-id"],se=ne(()=>m("span",null,[m("span",{style:{color:"red"}},"*"),k("参数值")],-1)),de={__name:"index",setup(d){const t=(e=null)=>({parentId:(e==null?void 0:e.id)||null,id:H(10),name:H(5),value:""}),_=g((()=>{const e=[t(),t(),t()];return e.forEach(r=>{e.push(t(r)),e.push(t(r))}),e})()),V=e=>{const r=[];e.forEach(l=>l.children=[]),e.forEach((l,o,u)=>{l.parentId===null?r.push(l):u.find(i=>i.id===l.parentId).children.push(l)});function p(l,o){l.forEach((u,c)=>{u.prop=o+c,u.children.length>0&&p(u.children,`${u.prop}.children.`)})}return p(r,"renderData."),r},v=g({rules:{value:[{required:!0,message:"必填",trigger:"blur"}]},renderData:[]});A(()=>_.value,e=>{v.value.renderData=V(e)},{immediate:!0});const D=()=>{let e=null,r=null,p=null;const l=document.querySelector(".el-table__body-wrapper tbody");return new j(l,{forceFallback:!0,fallbackClass:"sortable-fallback",handle:".el-table__cell:first-child",draggable:".el-table__row",onStart(o){const c=o.item.querySelector("span[sortable-id]").getAttribute("sortable-id");e=_.value.find(i=>`${i.id}`==`${c}`)},onMove(o){return p=o.related,!1},onEnd(o){if(!p)return;const u=p.querySelector("span[sortable-id]").getAttribute("sortable-id");r=_.value.find(i=>`${i.id}`==`${u}`);function c(i,h,b){return h?h.parentId===i.id?!0:h?c(i,b.find(w=>w.id===h.parentId),b):!1:!1}if(c(e,r,_.value)){console.warn("不能放置到子节点下");return}e.parentId=r.id,_.value=[..._.value]}})};let I=null;F(()=>{I=D()}),U(()=>{I.destroy()});const $=g(null),z=async()=>{await $.value.validate()},B=e=>{_.value=[..._.value,t(e)]};return(e,r)=>{const p=oe,l=q,o=G,u=K,c=P,i=Y,h=J,b=R,w=Z;return E(),x(M,null,[a(w,{ref_key:"form",ref:$,rules:v.value.rules,model:v.value},{default:n(()=>[a(b,{data:v.value.renderData,"row-key":"id","default-expand-all":""},{default:n(()=>[a(o,{type:"index",label:"",width:"44"},{default:n(s=>[m("span",{"sortable-id":s.row.id},[a(l,{"data-id":s.id},{default:n(()=>[a(p)]),_:2},1032,["data-id"])],8,re)]),_:1}),a(o,{prop:"name",label:"参数名称",width:"500"},{default:n(s=>[m("span",null,S(s.row.name),1)]),_:1}),a(o,{prop:"value",label:"参数值",width:"300"},{header:n(()=>[se]),default:n(s=>[a(c,{prop:`${s.row.prop}.value`,rules:v.value.rules.value},{default:n(()=>[a(u,{modelValue:s.row.value,"onUpdate:modelValue":y=>s.row.value=y,maxlength:30,placeholder:"请输入参数值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["prop","rules"])]),_:1}),a(o,{prop:"id",label:"id",width:"200px"},{default:n(s=>[m("span",null,S(s.row.id),1)]),_:1}),a(o,{prop:"id",label:"操作",width:"70"},{default:n(s=>[a(h,{onClick:y=>B(s.row)},{default:n(()=>[a(l,null,{default:n(()=>[a(i)]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["rules","model"]),m("div",null,[a(h,{type:"primary",onClick:z},{default:n(()=>[k(" 提交 ")]),_:1})])],64)}}},Ee=T(de,[["__scopeId","data-v-9616b8de"]]);export{Ee as default};
